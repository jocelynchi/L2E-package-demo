<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the L2E Package (version 2.0) • L2E</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the L2E Package (version 2.0)">
<meta property="og:description" content="L2E">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">L2E</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/l2e-intro.html">Introduction to the L2E Package (version 2.0)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="l2e-intro_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the L2E Package (version
2.0)</h1>
                        <h4 class="author">Xiaoqian Liu, Jocelyn T. Chi,
Lisa Lin, Kennth Lange, and Eric C. Chi</h4>
            
      
      
      <div class="hidden name"><code>l2e-intro.Rmd</code></div>

    </div>

    
    
<style>
img{ background:none; border:none; box-shadow:none; }
</style>
<p><span class="math display">\[
\newcommand{\vbeta}{\boldsymbol{\beta}}
\]</span></p>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The <code>L2E</code> package (version 2.0) implements the
computational framework for L<span class="math inline">\(_2\)</span>E
regression in <span class="citation">Liu, Chi, and Lange (2022)</span>,
which was built on the previous work in <span class="citation">Chi and
Chi (2022)</span>. Both work use the block coordinate descent strategy
to solve a nonconvex optimization problem but employ different methods
for the inner block descent updates. We refer to the method in <span class="citation">Liu, Chi, and Lange (2022)</span> as “MM” and the one
in <span class="citation">Chi and Chi (2022)</span> as “PG” in our
package. This vignette provides code to replicate some examples
illustrating the usage of the frameworks in both papers and the
improvements from <span class="citation">Liu, Chi, and Lange
(2022)</span>.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="isotonic-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#isotonic-regression" class="anchor"></a>Isotonic Regression</h3>
<p>The first example illustrates how to perform robust isotonic
regression via the L<span class="math inline">\(_{2}\)</span> criterion,
also called L<span class="math inline">\(_2\)</span>E isotonic
regression. We begin by generating the true fit <span class="math inline">\(f\)</span> from a cubic function (depicted by the
black line on the figure below). We obtain the observed response by
adding some Gaussian noise to <span class="math inline">\(f\)</span>
(depicted by the gray points on the figure below).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>, length.out<span class="op">=</span><span class="va">n</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">f</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">tau</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The <code>L2E_isotonic</code> function provides two options for
implementing the L<span class="math inline">\(_2\)</span>E isotonic
regression. By setting the argument “method = MM” (the default), the
function calls <code>l2e_regression_isotonic_MM</code> to perform L<span class="math inline">\(_2\)</span>E isotonic regression using the MM
method in <span class="citation">Liu, Chi, and Lange (2022)</span>.
Setting “method = PG” leads the function to call
<code>l2e_regression_isotonic</code> to perform L<span class="math inline">\(_2\)</span>E isotonic regression using the PG
method in <span class="citation">Chi and Chi (2022)</span>.</p>
<p>We obtain and compare three estimates for the underlying fit <span class="math inline">\(f\)</span> from the classical least squares (LS),
the L<span class="math inline">\(_{2}\)</span>E with MM, and the L<span class="math inline">\(_{2}\)</span>E with PG, respectively. The true fit
is shown in black while the fits from the LS, the L<span class="math inline">\(_{2}\)</span>E with MM, and the L<span class="math inline">\(_{2}\)</span>E with PG are shown in blue, red, and
green, respectively. In the absence of outliers, all methods produce
similar estimates. For the two L<span class="math inline">\(_{2}\)</span>E methods, MM is faster than PG.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">L2E</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://r-forge.r-project.org/projects/psychor/">isotone</a></span><span class="op">)</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">y</span>
<span class="co"># LS method</span>
<span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/isotone/man/gpava.html">gpava</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">x</span>
<span class="co"># MM method</span>
<span class="va">sol_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_isotonic.html">L2E_isotonic</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">"MM"</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.153   0.000   0.152 </code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PG method</span>
<span class="va">sol_pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_isotonic.html">L2E_isotonic</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">'PG'</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.320   0.003   0.324 </code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plots</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">iso</span>, col<span class="op">=</span><span class="st">'blue'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## LS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'red'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## MM</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_pg</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'green'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## PG</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LS"</span>, <span class="st">"MM"</span>, <span class="st">"PG"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'blue'</span>,<span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Next, we introduce some outliers by perturbing some of the observed
responses.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">ix</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">num</span>
<span class="va">y</span><span class="op">[</span><span class="fl">45</span> <span class="op">+</span> <span class="va">ix</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We obtain the three estimates with the outlying points. The L<span class="math inline">\(_{2}\)</span>E fits are less sensitive to outliers
than the LS fit in this example. The two methods MM and PG produce
comparable estimates, but MM is faster than PG.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">y</span>
<span class="co"># LS method</span>
<span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/isotone/man/gpava.html">gpava</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">x</span>
<span class="co"># MM method</span>
<span class="va">sol_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_isotonic.html">L2E_isotonic</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">"MM"</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.041   0.000   0.041 </code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PG method</span>
<span class="va">sol_pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_isotonic.html">L2E_isotonic</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">'PG'</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.187   0.000   0.187 </code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plots</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>,  col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">iso</span>, col<span class="op">=</span><span class="st">'blue'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## LS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'red'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## MM</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_pg</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'green'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## PG</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LS"</span>, <span class="st">"MM"</span>, <span class="st">"PG"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'blue'</span>,<span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="convex-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#convex-regression" class="anchor"></a>Convex Regression</h3>
<p>The second example illustrates how to perform robust convex
regression via the L<span class="math inline">\(_{2}\)</span> criterion,
also called L<span class="math inline">\(_2\)</span>E convex regression.
We begin by simulating a convex function <span class="math inline">\(f\)</span>. The observed response is composed of
<span class="math inline">\(f\)</span> with some additive Gaussian
noise.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out<span class="op">=</span><span class="va">n</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">4</span> <span class="op">+</span> <span class="va">x</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">f</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">tau</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, col<span class="op">=</span><span class="st">'black'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The <code>L2E_convex</code> function provides two options for
implementing the L<span class="math inline">\(_2\)</span>E convex
regression. By setting the argument “method = MM” (the default), the
function calls <code>l2e_regression_convex_MM</code> to perform L<span class="math inline">\(_2\)</span>E convex regression using the MM method
in <span class="citation">Liu, Chi, and Lange (2022)</span>. Setting
“method = PG” leads the function to call
<code>l2e_regression_convex</code> to perform L<span class="math inline">\(_2\)</span>E convex regression using the PG method
in <span class="citation">Chi and Chi (2022)</span>.</p>
<p>We obtain and compare three estimates for the underlying fit <span class="math inline">\(f\)</span> from the classical least squares (LS),
the L<span class="math inline">\(_{2}\)</span>E with MM, and the L<span class="math inline">\(_{2}\)</span>E with PG, respectively. The true fit
is shown in black while the fits from the LS, the L<span class="math inline">\(_{2}\)</span>E with MM, and the L<span class="math inline">\(_{2}\)</span>E with PG are shown in blue, red, and
green, respectively. In the absence of outliers, all methods produce
similar estimates. For the two L<span class="math inline">\(_{2}\)</span>E methods, MM is faster than PG.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://curves-etc.r-forge.r-project.org/">cobs</a></span><span class="op">)</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">y</span>
<span class="co">## LS method</span>
<span class="va">cvx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/cobs/man/conreg.html">conreg</a></span><span class="op">(</span><span class="va">y</span>, convex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## MM method</span>
<span class="va">sol_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_convex.html">L2E_convex</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">"MM"</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.137   0.000   0.137 </code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PG method</span>
<span class="va">sol_pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_convex.html">L2E_convex</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">'PG'</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  1.124   0.000   1.124 </code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cvx</span>, col<span class="op">=</span><span class="st">'blue'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## LS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'red'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## MM</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_pg</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'green'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## PG</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LS"</span>, <span class="st">"MM"</span>, <span class="st">"PG"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'blue'</span>,<span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Next, we again introduce some outlying points.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="va">ix</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">num</span>
<span class="va">y</span><span class="op">[</span><span class="fl">45</span> <span class="op">+</span> <span class="va">ix</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span>
 
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, col<span class="op">=</span><span class="st">'black'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We obtain the three estimates with the outlying points. The L<span class="math inline">\(_{2}\)</span>E fits are less sensitive to outliers
than the LS fit in this example. The MM method not only requires less
computional time but also produces better estimation than the PG
method.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">y</span>
<span class="co">## LS method</span>
<span class="va">cvx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/cobs/man/conreg.html">conreg</a></span><span class="op">(</span><span class="va">y</span>, convex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## MM method</span>
<span class="va">sol_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_convex.html">L2E_convex</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">"MM"</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.179   0.000   0.179 </code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PG method</span>
<span class="va">sol_pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_convex.html">L2E_convex</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">b</span>, <span class="va">tau</span>, method <span class="op">=</span> <span class="st">'PG'</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  2.905   0.000   2.905 </code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">'gray'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cvx</span>, col<span class="op">=</span><span class="st">'blue'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## LS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'red'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## MM</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sol_pg</span><span class="op">$</span><span class="va">beta</span>, col<span class="op">=</span><span class="st">'green'</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">## PG</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LS"</span>, <span class="st">"MM"</span>, <span class="st">"PG"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'blue'</span>,<span class="st">'red'</span>, <span class="st">'green'</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="multivariate-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#multivariate-regression" class="anchor"></a>Multivariate Regression</h3>
<p>The third example provides code to perform L<span class="math inline">\(_{2}\)</span>E multivariate regression with the
Hertzsprung-Russell diagram data of star cluster CYG OB1. The data set
is commonly used in robust regression owing to its four known outliers –
four bright giant stars observed at low temperatures. The data set is
publicly available in the R package <code>robustbase</code>. We begin by
loading the data from the <code>robustbase</code> package.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://robustbase.r-forge.r-project.org/">robustbase</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">starsCYG</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">starsCYG</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We use the <code>L2E_multivariate</code> function to perform the
L<span class="math inline">\(_2\)</span>E multivariate reeegression,
namely, multivariate regression via the L<span class="math inline">\(_{2}\)</span> criterion. The
<code>L2E_multivariate</code> function provides two options for
implementing the L<span class="math inline">\(_2\)</span>E multivariate
regression. By setting the argument “method = MM” (the default), the
function calls <code>l2e_regression_MM</code> to perform L<span class="math inline">\(_2\)</span>E multivariate regression using the MM
method in <span class="citation">Liu, Chi, and Lange (2022)</span>.
Setting “method = PG” leads the function to call
<code>l2e_regression</code> to perform L<span class="math inline">\(_2\)</span>E multivariate regression using the PG
method in <span class="citation">Chi and Chi (2022)</span>.</p>
<p>We next use the MM method to fit the L<span class="math inline">\(_2\)</span>E multivariate regression model and
compare it to the least squares fit. The figure below shows that the
L<span class="math inline">\(_2\)</span>E fit can reduce the influence
of the four outliers and fits the remaining data points well. The LS fit
is heavily affected by the four outliers.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">starsCYG</span><span class="op">[</span>, <span class="st">"log.light"</span><span class="op">]</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">starsCYG</span><span class="op">[</span>, <span class="st">"log.Te"</span><span class="op">]</span>
<span class="va">X0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="va">x</span><span class="op">)</span>

<span class="co"># LS method</span>
<span class="va">mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">log.light</span> <span class="op">~</span> <span class="va">log.Te</span>, data <span class="op">=</span> <span class="va">starsCYG</span><span class="op">)</span>
<span class="va">r_lm</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">X0</span> <span class="op">%*%</span> <span class="va">mle</span><span class="op">$</span><span class="va">coefficients</span>

<span class="co"># L2E+MM method</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="co"># Fit the regression model</span>
<span class="va">sol_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/L2E_multivariate.html">L2E_multivariate</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X0</span>, <span class="va">b</span>, <span class="va">tau</span>, method<span class="op">=</span><span class="st">"MM"</span><span class="op">)</span></code></pre></div>
<pre><code>   user  system elapsed 
  0.017   0.000   0.017 </code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">l2e_fit_mm</span> <span class="op">&lt;-</span> <span class="va">X0</span> <span class="op">%*%</span> <span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span>
<span class="co"># compute limit weights</span>
<span class="va">r_mm</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">l2e_fit_mm</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">l2e_fit_mm</span><span class="op">)</span>


<span class="va">d_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">mle</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
                      sl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sol_mm</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">mle</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
                      col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,
                      lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"dashed"</span><span class="op">)</span>,
                      method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L2E"</span>, <span class="st">"LS"</span><span class="op">)</span><span class="op">)</span>

<span class="va">ltys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">d_lines</span><span class="op">$</span><span class="va">lty</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ltys</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">d_lines</span><span class="op">$</span><span class="va">lty</span><span class="op">)</span>

<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">d_lines</span><span class="op">$</span><span class="va">col</span><span class="op">)</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">d_lines</span><span class="op">$</span><span class="va">lty</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">method</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">d_lines</span><span class="op">$</span><span class="va">method</span><span class="op">)</span>


<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_lines</span><span class="op">[</span><span class="va">d_lines</span><span class="op">$</span><span class="va">col</span> <span class="op">==</span> <span class="st">"red"</span>, <span class="op">]</span>, 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">int</span>, slope <span class="op">=</span> <span class="va">sl</span>, lty <span class="op">=</span> <span class="va">lty</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_lines</span><span class="op">[</span><span class="va">d_lines</span><span class="op">$</span><span class="va">col</span> <span class="op">==</span> <span class="st">"blue"</span>, <span class="op">]</span>, 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">int</span>, slope <span class="op">=</span> <span class="va">sl</span>, lty <span class="op">=</span> <span class="va">lty</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_linetype_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Method"</span>, values <span class="op">=</span> <span class="va">ltys</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dashed"</span>, <span class="st">"solid"</span><span class="op">)</span>,
                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LS  "</span>, 
                                   <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">L</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">~</span><span class="va">E</span><span class="op">)</span><span class="op">)</span>,
                        guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cols</span><span class="op">)</span>, legend<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We next show how to use the convereged weights from the MM method to
identify outliers in the data. As discussed in <span class="citation">Liu, Chi, and Lange (2022)</span>, a small weight
suggests a potential outlier.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span> <span class="op">(</span><span class="va">sol_mm</span><span class="op">$</span><span class="va">tau</span><span class="op">*</span><span class="va">r_mm</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">)</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">l2e_fit_mm</span>, <span class="va">w</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    y<span class="op">=</span><span class="st">"Count"</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">~</span><span class="st">'(w)'</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The four extremely small weights in the above histogram indicate that
there are four potential outliers in the data. Next, we incorporate the
four outliers into the scatter plot. The MM method successfully identify
the four outliers.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outlier_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">1e-5</span><span class="op">)</span> <span class="co"># the threshold value can range from 1e-3 to 1e-14 according to the histogram</span>
    <span class="va">outlier_mm</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"no"</span>
<span class="op">}</span>
<span class="va">outlier_mm</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">outlier_mm</span> , levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">l2e_fit_mm</span>, <span class="va">outlier_mm</span><span class="op">)</span>


<span class="va">p</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color<span class="op">=</span><span class="va">outlier_mm</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"Outlier"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    y<span class="op">=</span><span class="st">"Light Intensity"</span>, x<span class="op">=</span><span class="st">"Temperature"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="l2e-intro_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="other-examples" class="section level3">
<h3 class="hasAnchor">
<a href="#other-examples" class="anchor"></a>Other Examples</h3>
<p>The new <code>L2E</code> package include implementation of L<span class="math inline">\(_2\)</span>E sparse regression and L<span class="math inline">\(_2\)</span>E trend filtering. The
<code>L2E_sparse_ncv</code> function computes a solution path of L<span class="math inline">\(_2\)</span>E sparse regression with exisitng
penalties available in the <code>ncvreg</code> package. The
<code>L2E_sparse_dist</code> function computes a solution path of L<span class="math inline">\(_2\)</span>E sparse regression with the distance
penalty. The <code>L2E_TF_lasso</code> function computes a solution path
of L<span class="math inline">\(_2\)</span>E trend filtering with the
Lasso penalty. The <code>L2E_TF_dist</code> function computes a solution
path of L<span class="math inline">\(_2\)</span>E trend filtering with
the distance penalty. Readers may refer to <span class="citation">Liu,
Chi, and Lange (2022)</span> for advantages of distance penalization in
the two examples of sparse regression and trend filtering.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-L2E-Chi" class="csl-entry">
Chi, Jocelyn T., and Eric C. Chi. 2022. <span>“A User-Friendly
Computational Framework for Robust Structured Regression with the l<span class="math inline">\(_2\)</span> Criterion.”</span> <em>Journal of
Computational and Graphical Statistics</em>, 1–12.
</div>
<div id="ref-L2E-Liu" class="csl-entry">
Liu, Xiaoqian, Eric C. Chi, and Kenneth Lange. 2022. <span>“A Sharper
Computational Tool for l<span class="math inline">\(_2\)</span>e
Regression.”</span> <em>arXiv Preprint arXiv:2203.02993</em>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://xiaoqian-liu.github.io/">Xiaoqian Liu</a>, <a href="https://jocelynchi.com">Jocelyn Chi</a>, <a href="https://bioscience.ucla.edu/people/kenneth-l-lange/">Kenneth Lange</a>, <a href="https://ericchi.com/">Eric Chi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
