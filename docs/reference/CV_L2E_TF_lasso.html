<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross validation for L2E trend filtering regression with Lasso penalization — CV_L2E_TF_lasso • L2E</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross validation for L2E trend filtering regression with Lasso penalization — CV_L2E_TF_lasso" />
<meta property="og:description" content="CV_L2E_TF_lasso performs k-fold cross-validation for robust trend filtering regression under the L2 criterion with the Lasso penalty" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">L2E</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/l2e-intro.html">Introduction to the L2E Package (version 2.0)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross validation for L2E trend filtering regression with Lasso penalization</h1>
    
    <div class="hidden name"><code>CV_L2E_TF_lasso.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>CV_L2E_TF_lasso</code> performs k-fold cross-validation for robust trend filtering regression under the L2 criterion with the Lasso penalty</p>
    </div>

    <pre class="usage"><span class='fu'>CV_L2E_TF_lasso</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>beta0</span>,
  <span class='va'>tau0</span>,
  <span class='va'>D</span>,
  <span class='va'>lambdaSeq</span>,
  nfolds <span class='op'>=</span> <span class='fl'>5</span>,
  seed <span class='op'>=</span> <span class='fl'>1234</span>,
  method <span class='op'>=</span> <span class='st'>"median"</span>,
  max_iter <span class='op'>=</span> <span class='fl'>100</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-04</span>,
  trace <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>Response vector</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>Design matrix. Default is the identity matrix.</p></td>
    </tr>
    <tr>
      <th>beta0</th>
      <td><p>Initial vector of regression coefficients, can be omitted</p></td>
    </tr>
    <tr>
      <th>tau0</th>
      <td><p>Initial precision estimate, can be omitted</p></td>
    </tr>
    <tr>
      <th>D</th>
      <td><p>The fusion matrix</p></td>
    </tr>
    <tr>
      <th>lambdaSeq</th>
      <td><p>A decreasing sequence of tuning parameter lambda, can be omitted</p></td>
    </tr>
    <tr>
      <th>nfolds</th>
      <td><p>The number of cross-validation folds. Default is 5.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Users can set the seed of the random number generator to obtain reproducible results.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Median or mean to calculate the objective value</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Relative tolerance</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>Whether to trace the progress of the cross-validation</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list object containing the mean and standard error of the cross-validation error -- CVE and CVSE -- for each value of k (vectors),
the index of the lambda with the minimum CVE and the lambda value itself (scalars),
the index of the lambda value with the 1SE CVE and the lambda value itself (scalars),
the sequence of lambda used in the regression (vector), and
a vector listing which fold each element of y was assigned to</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Completes in 30 seconds</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>,<span class='fl'>5</span>,<span class='fl'>0</span>,<span class='op'>-</span><span class='fl'>10</span><span class='op'>)</span>, each<span class='op'>=</span><span class='va'>n</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='va'>f</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Clean Data</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, pch<span class='op'>=</span><span class='fl'>16</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.axis<span class='op'>=</span><span class='fl'>1.5</span>, cex.sub<span class='op'>=</span><span class='fl'>1.5</span>, col<span class='op'>=</span><span class='st'>'gray'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='CV_L2E_TF_lasso-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fu'><a href='myGetDkn.html'>myGetDkn</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>lambda</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>2</span>, length.out<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span>
<span class='va'>cv</span> <span class='op'>&lt;-</span> <span class='fu'>CV_L2E_TF_lasso</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y0</span>, D<span class='op'>=</span><span class='va'>D</span>, lambdaSeq<span class='op'>=</span><span class='va'>lambda</span>, nfolds<span class='op'>=</span><span class='fl'>2</span>, seed<span class='op'>=</span><span class='fl'>1234</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Starting CV fold #1
#&gt; Starting CV fold #2</div><div class='input'><span class='op'>(</span><span class='va'>lambda_min</span> <span class='op'>&lt;-</span> <span class='va'>cv</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.01</div><div class='input'>
<span class='va'>sol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='L2E_TF_lasso.html'>L2E_TF_lasso</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y0</span>, D<span class='op'>=</span><span class='va'>D</span>, lambdaSeq<span class='op'>=</span><span class='va'>lambda_min</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.073   0.004   0.077 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, pch<span class='op'>=</span><span class='fl'>16</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.axis<span class='op'>=</span><span class='fl'>1.5</span>, cex.sub<span class='op'>=</span><span class='fl'>1.5</span>, col<span class='op'>=</span><span class='st'>'gray'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>sol</span><span class='op'>$</span><span class='va'>Beta</span>, col<span class='op'>=</span><span class='st'>'blue'</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='CV_L2E_TF_lasso-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Contaminated Data</span>
<span class='va'>ix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>, <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>ix</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>y0</span><span class='op'>[</span><span class='va'>ix</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>2</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, pch<span class='op'>=</span><span class='fl'>16</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.axis<span class='op'>=</span><span class='fl'>1.5</span>, cex.sub<span class='op'>=</span><span class='fl'>1.5</span>, col<span class='op'>=</span><span class='st'>'gray'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='CV_L2E_TF_lasso-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>cv</span> <span class='op'>&lt;-</span> <span class='fu'>CV_L2E_TF_lasso</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y</span>, D<span class='op'>=</span><span class='va'>D</span>, lambdaSeq<span class='op'>=</span><span class='va'>lambda</span>, nfolds<span class='op'>=</span><span class='fl'>2</span>, seed<span class='op'>=</span><span class='fl'>1234</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Starting CV fold #1
#&gt; Starting CV fold #2</div><div class='input'><span class='op'>(</span><span class='va'>lambda_min</span> <span class='op'>&lt;-</span> <span class='va'>cv</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.08858668</div><div class='input'>
<span class='va'>sol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='L2E_TF_lasso.html'>L2E_TF_lasso</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y</span>, D<span class='op'>=</span><span class='va'>D</span>, lambdaSeq<span class='op'>=</span><span class='va'>lambda_min</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.063   0.000   0.063 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, pch<span class='op'>=</span><span class='fl'>16</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.axis<span class='op'>=</span><span class='fl'>1.5</span>, cex.sub<span class='op'>=</span><span class='fl'>1.5</span>, col<span class='op'>=</span><span class='st'>'gray'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>sol</span><span class='op'>$</span><span class='va'>Beta</span>, col<span class='op'>=</span><span class='st'>'blue'</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='CV_L2E_TF_lasso-4.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://xiaoqian-liu.github.io/'>Xiaoqian Liu</a>, <a href='https://jocelynchi.com'>Jocelyn Chi</a>, <a href='https://bioscience.ucla.edu/people/kenneth-l-lange/'>Kenneth Lange</a>, <a href='https://ericchi.com/'>Eric Chi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


